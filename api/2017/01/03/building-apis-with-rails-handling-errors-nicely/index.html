<!DOCTYPE html>
<html>

  <head>
  <meta charset="utf-8">
  <!-- (1) Optimize for mobile versions: http://goo.gl/EOpFl -->
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <!-- (1) force latest IE rendering engine: bit.ly/1c8EiC9 -->
  <meta http-equiv="X-UA-Compatible" content="IE=edge">

  <title>Building APIs with Rails: Handling Errors Nicely | Phil Sturgeon</title>
  <meta name="description" content="Platform Engineer @ WeWork who talks about APIs a lot. Programming Polyglot, Pragmatist, Centerist and Sarcasist. Ex-The League of Extraordinary Packages, PHP The Right Way, Ex-PHP-FIG, Ex-CodeIgniter, Ex-FuelPHP, Ex-PyroCMS." />

  <meta name="HandheldFriendly" content="True" />
  <meta name="MobileOptimized" content="320" />
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">

  <link rel="stylesheet" href="//brick.a.ssl.fastly.net/Linux+Libertine:400,400i,700,700i/Open+Sans:400,400i,700,700i">
  <link href="//maxcdn.bootstrapcdn.com/font-awesome/4.2.0/css/font-awesome.min.css" rel="stylesheet">

  <link href="/stylesheets/main.css" rel="stylesheet" media="screen" />
  <link href="/stylesheets/print.css" rel="stylesheet" media="print" />
  <link href="/images/favicon.jpg" rel="icon" type="image/jpg" />

  <meta property="og:title" content="Building APIs with Rails: Handling Errors Nicely" />
  <meta property="og:type" content="article" />
  <meta property="article:author" content="Phil Sturgeon" />
  <meta property="og:description" content="Ignoring one session covering basic CRUD and deserialization using ActiveModel::Serializer, we get to a more interesting session: Handling Errors Nicely." />
  <meta property="og:site_name" content="Phil Sturgeon" />
  <meta property="og:image" content="https://philsturgeon.uk/images/author.jpg" />
  <meta property="og:url" content="https://philsturgeon.uk/api/2017/01/03/building-apis-with-rails-handling-errors-nicely/" />
  <meta property="og:locale" content="en_GB" />

  <meta name="twitter:card" content="summary">
  <meta name="twitter:site" content="@philsturgeon">
  <meta name="twitter:title" content="Building APIs with Rails: Handling Errors Nicely | Phil Sturgeon">
  <meta name="twitter:image:src" content="https://philsturgeon.uk/images/author.jpg">
  <meta name="twitter:url" content="https://philsturgeon.uk/api/2017/01/03/building-apis-with-rails-handling-errors-nicely/">
  <meta name="twitter:description" content="Ignoring one session covering basic CRUD and deserialization using ActiveModel::Serializer, we get to a more interesting session: Handling Errors Nicely.">
  <meta name="twitter:creator" content="@philsturgeon">

  <link rel="alternate" type="application/atom+xml" title="Atom Feed" href="/feed.xml" />
</head>


  <body>

    <a class='fa fa-home logo-readium' href='/'></a>


    <!-- content start -->

    <main class="content" role="main">
      <article class="post">
        <div class="noarticleimage">
          <div class="post-meta">
            <h1 class="post-title">Building APIs with Rails: Handling Errors Nicely</h1>
            <div class="cf post-meta-text">
              <div class="author-image" style="background-image: url(/images/author.jpg)">Blog Logo</div>
              <h4 class="author-name" itemprop="author" itemscope itemtype="http://schema.org/Person">Phil Sturgeon</h4>
              on
              <time datetime="2017-01-03 10:00:00 UTC">
                Jan  3 2017
              </time>
              <a href="/tag/building-rest-apis-in-rails/">#building-rest-apis-in-rails</a>
              <a href="/tag/rspec/">#rspec</a>
              <a href="/tag/rails/">#rails</a>
              <a href="/tag/video/">#video</a>
            </div>
          </div>
        </div>
        <br>
        <br>
        <br>
        <section class="post-content">
          <div class="post-reading">
            <span class="post-reading-time"></span> read
          </div>
          <a name="topofpage"></a>
          <p>More videos in this practice series "Building REST APIs with Rails":</p>
<ul>
  <li>
    Episode 1:
    <a href='/api/2016/11/22/apis-documentation-first/'>Documenting Your API First</a>
  </li>
  <li>
    Episode 2:
    <a href='/api/2016/12/02/mocking-apis-with-api-blueprint/'>Mocking APIs with API Blueprint</a>
  </li>
  <li>
    Episode 3:
    <a href='/api/2016/12/11/building-apis-with-rails-basic-serialization/'>Basic Serialization</a>
  </li>
  <li>
    Episode 4:
    <a href='/api/2016/12/21/building-rest-apis-with-rails-documentation-testing/'>Documentation Testing</a>
  </li>
  <li>
    Episode 5 & 6:
    <a href='/api/2017/01/03/building-apis-with-rails-handling-errors-nicely/'>Handling Errors Nicely</a>
  </li>
</ul>
<hr>

          <p>Ignoring one session covering <a href="https://www.youtube.com/watch?v=GpNEbw33GL8">basic CRUD and deserialization</a> using <a href="https://github.com/rails-api/active_model_serializers/blob/master/docs/general/deserialization.md">ActiveModel::Serializer</a>, we get to a more interesting session: Handling Errors Nicely.</p>

<p>Handling errors is tough, and often overlooked. A lot of people think returning errors is
just a case of spitting <code>{ "error": "Whatever went wrong." }</code> out to the browser with a HTTP
status code, but there is a lot more to it than that. Errors need to be human readable, and computer readable.</p>

<p>Outputting a string is a good way to make it human readable, but is not good enough for computers. Do not force other developers to substring match your error messages just because you were lazy.</p>

<p>A HTTP status code can help computers get an idea of what <em>sort</em> of error is happening, but <a href="https://philsturgeon.uk/http/2015/09/23/http-status-codes-are-not-enough/">is not enough by itself</a>.
Status codes are only a category of error. In most applications, multiple errors on the same endpoint could
share the same status code, so an application-specific error code should be used too.</p>

<iframe width="560" height="315" src="https://www.youtube.com/embed/bHUjkQz6hxI" frameborder="0" allowfullscreen=""></iframe>

<p><strong><a href="https://github.com/philsturgeon/livecoding-apisyouwonthate/tree/master/episode-06-handling-errors-nicely">Source Code</a></strong></p>

<hr />

<p><a href="http://jsonapi.org/">JSON-API</a> has some pretty good ideas about <a href="http://jsonapi.org/format/#errors">how errors should look</a>, so let's use that.</p>

<p>Firstly, let's create a convenience method in our <code>ApplicationController</code> which will let specify a status code and an error code to create an error:</p>

<pre class="highlight ruby"><code><span class="c1"># app/controllers/application_controller.rb</span>

<span class="k">class</span> <span class="nc">ApplicationController</span> <span class="o">&lt;</span> <span class="no">ActionController</span><span class="o">::</span><span class="no">Base</span>

  <span class="c1"># ...</span>

  <span class="k">def</span> <span class="nf">render_json_error</span><span class="p">(</span><span class="n">status</span><span class="p">,</span> <span class="n">error_code</span><span class="p">,</span> <span class="n">extra</span> <span class="o">=</span> <span class="p">{})</span>
    <span class="n">status</span> <span class="o">=</span> <span class="no">Rack</span><span class="o">::</span><span class="no">Utils</span><span class="o">::</span><span class="no">SYMBOL_TO_STATUS_CODE</span><span class="p">[</span><span class="n">status</span><span class="p">]</span> <span class="k">if</span> <span class="n">status</span><span class="p">.</span><span class="nf">is_a?</span> <span class="no">Symbol</span>

    <span class="n">error</span> <span class="o">=</span> <span class="p">{</span>
      <span class="ss">title: </span><span class="no">I18n</span><span class="p">.</span><span class="nf">t</span><span class="p">(</span><span class="s2">"error_messages.</span><span class="si">#{</span><span class="n">error_code</span><span class="si">}</span><span class="s2">.title"</span><span class="p">),</span>
      <span class="ss">status: </span><span class="n">status</span><span class="p">,</span>
      <span class="ss">code: </span><span class="no">I18n</span><span class="p">.</span><span class="nf">t</span><span class="p">(</span><span class="s2">"error_messages.</span><span class="si">#{</span><span class="n">error_code</span><span class="si">}</span><span class="s2">.code"</span><span class="p">)</span>
    <span class="p">}.</span><span class="nf">merge</span><span class="p">(</span><span class="n">extra</span><span class="p">)</span>

    <span class="n">detail</span> <span class="o">=</span> <span class="no">I18n</span><span class="p">.</span><span class="nf">t</span><span class="p">(</span><span class="s2">"error_messages.</span><span class="si">#{</span><span class="n">error_code</span><span class="si">}</span><span class="s2">.detail"</span><span class="p">,</span> <span class="ss">default: </span><span class="s1">''</span><span class="p">)</span>
    <span class="n">error</span><span class="p">[</span><span class="ss">:detail</span><span class="p">]</span> <span class="o">=</span> <span class="n">detail</span> <span class="k">unless</span> <span class="n">detail</span><span class="p">.</span><span class="nf">empty?</span>

    <span class="n">render</span> <span class="ss">json: </span><span class="p">{</span> <span class="ss">errors: </span><span class="p">[</span><span class="n">error</span><span class="p">]</span> <span class="p">},</span> <span class="ss">status: </span><span class="n">status</span>
  <span class="k">end</span>

<span class="k">end</span>
</code></pre>

<p>Then we should populate a locale file, so we have that copy written down:</p>

<pre class="highlight yaml"><code><span class="c1"># config/locale/errors.yml</span>

<span class="s">en</span><span class="pi">:</span>
  <span class="s">error_messages</span><span class="pi">:</span>

    <span class="c1"># Products</span>
    <span class="s">product_not_found</span><span class="pi">:</span>
      <span class="s">code</span><span class="pi">:</span> <span class="s">20101</span>
      <span class="s">title</span><span class="pi">:</span> <span class="s2">"</span><span class="s">Could</span><span class="nv"> </span><span class="s">not</span><span class="nv"> </span><span class="s">find</span><span class="nv"> </span><span class="s">product"</span>
      <span class="s">detail</span><span class="pi">:</span> <span class="s2">"</span><span class="s">This</span><span class="nv"> </span><span class="s">product</span><span class="nv"> </span><span class="s">does</span><span class="nv"> </span><span class="s">not</span><span class="nv"> </span><span class="s">exist,</span><span class="nv"> </span><span class="s">or</span><span class="nv"> </span><span class="s">has</span><span class="nv"> </span><span class="s">been</span><span class="nv"> </span><span class="s">deleted.</span><span class="nv"> </span><span class="s">Product</span><span class="nv"> </span><span class="s">can</span><span class="nv"> </span><span class="s">be</span><span class="nv"> </span><span class="s">removed</span><span class="nv"> </span><span class="s">by</span><span class="nv"> </span><span class="s">manufacturers</span><span class="nv"> </span><span class="s">or</span><span class="nv"> </span><span class="s">admins."</span>

    <span class="c1"># Manufacturers</span>
    <span class="s">manufacturers_not_found</span><span class="pi">:</span>
      <span class="s">code</span><span class="pi">:</span> <span class="s">20201</span>
      <span class="s">title</span><span class="pi">:</span> <span class="s2">"</span><span class="s">Could</span><span class="nv"> </span><span class="s">not</span><span class="nv"> </span><span class="s">find</span><span class="nv"> </span><span class="s">manufacturer"</span>
      <span class="s">detail</span><span class="pi">:</span> <span class="s2">"</span><span class="s">This</span><span class="nv"> </span><span class="s">manufacturer</span><span class="nv"> </span><span class="s">is</span><span class="nv"> </span><span class="s">no</span><span class="nv"> </span><span class="s">longer</span><span class="nv"> </span><span class="s">available."</span>
</code></pre>

<p>Now, we can call it from any of of controller methods, or rescue in the controller for exceptions we expect to see from multiple methods:</p>

<pre class="highlight ruby"><code><span class="c1"># app/controllers/products_controller.rb</span>

<span class="k">class</span> <span class="nc">ProductsController</span> <span class="o">&lt;</span> <span class="no">ApplicationController</span>

  <span class="n">rescue_from</span> <span class="no">ActiveRecord</span><span class="o">::</span><span class="no">RecordNotFound</span> <span class="k">do</span> <span class="o">|</span><span class="n">e</span><span class="o">|</span>
    <span class="n">render_json_error</span> <span class="ss">:not_found</span><span class="p">,</span> <span class="ss">:product_not_found</span>
  <span class="k">end</span>

  <span class="c1"># ...</span>

  <span class="k">def</span> <span class="nf">show</span>
    <span class="n">product</span> <span class="o">=</span> <span class="no">Product</span><span class="p">.</span><span class="nf">find</span><span class="p">(</span><span class="n">params</span><span class="p">[</span><span class="ss">:id</span><span class="p">])</span>
    <span class="n">render</span> <span class="ss">json: </span><span class="n">product</span>
  <span class="k">end</span>

<span class="k">end</span>
</code></pre>

<p>This covers specifying errors manually, but what about validation messages?</p>

<p>Validation errors should be considered errors, nothing less. A validation error means the thing the caller tried to do didn't work, so that needs to be an error, and it should be as clear as possible what the issue was.</p>

<p>Seeing as we're already using <code>ActiveModel::Serializer</code> in other places, it seems only sensible to utilize its built in JSON-API error support.</p>

<p>Let's make another convenience method:</p>

<pre class="highlight ruby"><code><span class="c1"># app/controllers/application_controller.rb</span>

<span class="k">class</span> <span class="nc">ApplicationController</span> <span class="o">&lt;</span> <span class="no">ActionController</span><span class="o">::</span><span class="no">Base</span>

  <span class="c1"># ...</span>

  <span class="k">def</span> <span class="nf">render_json_validation_error</span><span class="p">(</span><span class="n">resource</span><span class="p">)</span>
    <span class="n">render</span> <span class="ss">json: </span><span class="n">resource</span><span class="p">,</span> <span class="ss">status: :bad_request</span><span class="p">,</span> <span class="ss">adapter: :json_api</span><span class="p">,</span> <span class="ss">serializer: </span><span class="no">ActiveModel</span><span class="o">::</span><span class="no">Serializer</span><span class="o">::</span><span class="no">ErrorSerializer</span>
  <span class="k">end</span>

<span class="k">end</span>
</code></pre>

<p>This method takes a <code>resource</code>, which for the purposes of this video will be an ActiveRecord model, but could be anything that handles <code>#errors</code> in a similar fashion.</p>

<p>We can then simply call this method with a resource that has failed to save:</p>

<pre class="highlight ruby"><code><span class="c1"># app/controllers/products_controller.rb</span>

<span class="k">class</span> <span class="nc">ProductsController</span> <span class="o">&lt;</span> <span class="no">ApplicationController</span>

  <span class="c1"># ...</span>

  <span class="k">def</span> <span class="nf">create</span>
    <span class="n">product</span> <span class="o">=</span> <span class="no">Product</span><span class="p">.</span><span class="nf">new</span><span class="p">(</span><span class="n">create_params</span><span class="p">)</span>

    <span class="k">if</span> <span class="o">!</span><span class="n">product</span><span class="p">.</span><span class="nf">save</span>
      <span class="n">render_json_validation_error</span> <span class="n">product</span>
      <span class="k">return</span>
    <span class="k">end</span>

    <span class="n">render</span> <span class="ss">json: </span><span class="n">product</span><span class="p">,</span> <span class="ss">status: :created</span>
  <span class="k">end</span>

<span class="k">end</span>
</code></pre>

<p>The output that <code>ActiveModel::Serializer</code> gives you is not ideal, but for now it's taking care of the basics, and making it clear
what the problems are.</p>

<pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="nt">"errors"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="nt">"source"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="nt">"pointer"</span><span class="p">:</span><span class="w"> </span><span class="s2">"/data/attributes/name"</span><span class="w">
      </span><span class="p">},</span><span class="w">
      </span><span class="nt">"detail"</span><span class="p">:</span><span class="w"> </span><span class="s2">"can't be blank"</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="nt">"source"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="nt">"pointer"</span><span class="p">:</span><span class="w"> </span><span class="s2">"/data/attributes/description"</span><span class="w">
      </span><span class="p">},</span><span class="w">
      </span><span class="nt">"detail"</span><span class="p">:</span><span class="w"> </span><span class="s2">"can't be blank"</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<p>I'll improve on this output at a later time, but this will do for this draft.</p>

<p>The next session will cover RSpec testing!</p>

<h2 id="interested-in-a-proper-series">Interested in a Proper Series?</h2>

<p>These rough videos will be replaced with a nicely recorded series, and to get updates about that, just let me know your email address.</p>

<!-- Begin MailChimp Signup Form -->
<link href="//cdn-images.mailchimp.com/embedcode/horizontal-slim-10_7.css" rel="stylesheet" type="text/css" />

<style type="text/css">
	#mc_embed_signup{background:#fff; clear:left; font:14px; width:100%;}
	/* Add your own MailChimp form style overrides in your site stylesheet or in this style block.
	   We recommend moving this block and the preceding CSS link to the HEAD of your HTML file. */
</style>

<div id="mc_embed_signup">
<form action="//apisyouwonthate.us10.list-manage.com/subscribe/post?u=f5c5ff66d95d11dec1b88cf54&amp;id=bef95bfd48" method="post" id="mc-embedded-subscribe-form" name="mc-embedded-subscribe-form" class="validate" target="_blank" novalidate="">
    <div id="mc_embed_signup_scroll">

	<input type="email" value="" name="EMAIL" class="email" id="mce-EMAIL" placeholder="email address" required="" />
    <!-- real people should not fill this in and expect good things - do not remove this or risk form bot signups-->
    <div style="position: absolute; left: -5000px;" aria-hidden="true"><input type="text" name="b_f5c5ff66d95d11dec1b88cf54_bef95bfd48" tabindex="-1" value="" /></div>
    <div class="clear"><input type="submit" value="Subscribe" name="subscribe" id="mc-embedded-subscribe" class="button" /></div>
    </div>
</form>
</div>

<!--End mc_embed_signup-->

          <hr>
<p>
  <em>If you appreciate these articles and want me to keep them coming, fire some coins over. Maybe I'll even run the next one through a spell checker.</em>
</p>
<p>
  <em>
    <strong>bitcoin</strong> - 1PNbuCjgATjaaHtq7zZKqe3FBL7ngyDi23<br/>
    <strong>etherium</strong> - 0x507d6E943885a5AeD76Fa3C43dB5C73a0f1Dc792
  </em>
</p>

        </section>
        <footer class="post-footer">
            <section class="share">
            </section>
            <section class="post-next-previous">
                <p>
                    Previous:
                    <a class="button" href="/api/2016/12/21/building-rest-apis-with-rails-documentation-testing/">Building APIs with Rails: Documentation Testing</a>
                </p>
                <p style="float:right">
                    Next:
                    <a class="button" href="/api/2017/01/24/graphql-vs-rest-overview/">GraphQL vs REST: Overview</a>
                </p>
            </section>
        </footer>
        <div class="bottom-teaser cf">
          <div class="more isLeft">
            <h5 class="index-headline featured"><span>Written by</span></h5>
            <section class="author">
              <div class="author-image" style="background-image: url(/images/author.jpg)">Blog Logo</div>
              <h4>Phil Sturgeon</h4>
              <p class="bio">Platform Engineer @ WeWork who talks about APIs a lot. Programming Polyglot, Pragmatist, Centerist and Sarcasist. Ex-The League of Extraordinary Packages, PHP The Right Way, Ex-PHP-FIG, Ex-CodeIgniter, Ex-FuelPHP, Ex-PyroCMS.</p>
            </section>
          </div>
          <div class="more isRight">
            <h5 class="index-headline featured"><span>More Writing</span></h5>
            <section class="author">
              <a href="http://apisyouwonthate.com/">
                <div class="book-image build-apis">Book Cover</div>
                <h4>Build APIs You Won't Hate</h4>
              </a>
              <p class="bio">Everyone and their dog wants an API, so you should probably learn how to build them.</p>
              <p><a href="http://apisyouwonthate.com/">Buy it from LeanPub or Amazon</a>.</p>
            </section>
          </div>
        </div>
      </article>

      <div id="disqus_thread"></div>
      <script type="text/javascript">
          /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
          var disqus_shortname = 'philsturgeon';


          /* * * DON'T EDIT BELOW THIS LINE * * */
          (function() {
              var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
              dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
              (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
          })();
      </script>
      <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>

    </main>
    <div class="bottom-closer">
      <div class="background-closer-image" style="background-image: url(/images/cover.jpg)">
        Image
      </div>
      <div class="inner">
        <h1 class="blog-title">Phil Sturgeon</h1>
        <h2 class="blog-description">Platform Engineer @ WeWork who talks about APIs a lot. Programming Polyglot, Pragmatist, Centerist and Sarcasist. Ex-The League of Extraordinary Packages, PHP The Right Way, Ex-PHP-FIG, Ex-CodeIgniter, Ex-FuelPHP, Ex-PyroCMS.</h2>
        <a href="/" class="btn">Back to Overview</a>
      </div>
    </div>

    <!-- content end -->

    <footer class='footer' role='contentinfo'>
  <div class='footer-links'>
    <ul class='context'>
      <li>
        <h3>Content</h3>
      </li>
      <li>
        <a href='/about'>About</a>
      </li>
      <li>
        <a href='/books'>Books</a>
      </li>
      <li>
        <a href='/speaking'>Speaking</a>
      </li>
    </ul>
    <ul class='follow'>
      <li>
        <h3>Follow Me</h3>
      </li>
      <li>
        <a href='https://twitter.com/philsturgeon'>Twitter</a>
      </li>
      <li>
        <a href='https://github.com/philsturgeon'>GitHub</a>
      </li>
      <li>
        <a href='http://apibusters.com/'>API Busters Podcast</a>
      </li>
      <li>
        <a href='http://phil.bike/'>Phil.Bike</a>
      </li>
    </ul>
    <ul class='recent_posts'>
      <li>
        <h3>Recent Posts</h3>
        <ul>
          <li><a href="/api/2018/04/13/openapi-and-json-schema-divergence-solved/">OpenAPI and JSON Schema Divergence: Part 2</a></li>
          <li><a href="/api/2018/03/30/openapi-and-json-schema-divergence/">OpenAPI and JSON Schema Divergence: Part 1</a></li>
          <li><a href="/api/2018/03/01/api-specification-workflow-matures/">Design-first API Specification Workflow Matures</a></li>
        </ul>
      </li>
    </ul>
  </div>
</footer>

    <script src="//code.jquery.com/jquery-1.11.3.min.js"></script>
<script src="/javascripts/jquery.fitvids.js"></script>
<script src="/javascripts/index.js"></script>
<script src="/javascripts/readingTime.min.js"></script>
<script>
(function ($) {
  "use strict";
  $(document).ready(function(){

    var $window = $(window),
    $image = $('.post-image-image, .teaserimage-image');
    $window.on('scroll', function() {
      var top = $window.scrollTop();

      if (top < 0 || top > 1500) { return; }
      $image
        .css('transform', 'translate3d(0px, '+top/3+'px, 0px)')
        .css('opacity', 1-Math.max(top/700, 0));
    });
    $window.trigger('scroll');

    var height = $('.article-image').height();
    $('.post-content').css('padding-top', height + 'px');

    $('a[href*=#]:not([href=#])').click(function() {
      if (location.pathname.replace(/^\//,'') == this.pathname.replace(/^\//,'')
       && location.hostname == this.hostname) {
        var target = $(this.hash);
        target = target.length ? target : $('[name=' + this.hash.slice(1) +']');
        if (target.length) {
          $('html,body').animate({ scrollTop: target.offset().top }, 500);
          return false;
        }
      }
    });
  });
}(jQuery));
</script>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-8523256-1', 'auto');
  ga('send', 'pageview');

</script>


  </body>

</html>
