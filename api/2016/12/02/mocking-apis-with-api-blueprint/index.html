<!DOCTYPE html>
<html>

  <head>
  <meta charset="utf-8">
  <!-- (1) Optimize for mobile versions: http://goo.gl/EOpFl -->
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <!-- (1) force latest IE rendering engine: bit.ly/1c8EiC9 -->
  <meta http-equiv="X-UA-Compatible" content="IE=edge">

  <title>Mocking APIs with API Blueprint | Phil Sturgeon</title>
  <meta name="description" content="Platform Engineer @ WeWork who talks about APIs a lot. Programming Polyglot, Pragmatist, Centerist and Sarcasist. Ex-The League of Extraordinary Packages, PHP The Right Way, Ex-PHP-FIG, Ex-CodeIgniter, Ex-FuelPHP, Ex-PyroCMS." />

  <meta name="HandheldFriendly" content="True" />
  <meta name="MobileOptimized" content="320" />
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">

  <link rel="stylesheet" href="//brick.a.ssl.fastly.net/Linux+Libertine:400,400i,700,700i/Open+Sans:400,400i,700,700i">
  <link href="//maxcdn.bootstrapcdn.com/font-awesome/4.2.0/css/font-awesome.min.css" rel="stylesheet">

  <link href="/stylesheets/main.css" rel="stylesheet" media="screen" />
  <link href="/stylesheets/print.css" rel="stylesheet" media="print" />
  <link href="/images/favicon.jpg" rel="icon" type="image/jpg" />

  <meta property="og:title" content="Mocking APIs with API Blueprint" />
  <meta property="og:type" content="article" />
  <meta property="article:author" content="Phil Sturgeon" />
  <meta property="og:description" content="The second video in a pile of LiveCoding.tv videos shows how to use your API Blueprint documentation to mock APIs, and a few different ways of serving those mocks up to people." />
  <meta property="og:site_name" content="Phil Sturgeon" />
  <meta property="og:image" content="https://philsturgeon.uk/images/author.jpg" />
  <meta property="og:url" content="https://philsturgeon.uk/api/2016/12/02/mocking-apis-with-api-blueprint/" />
  <meta property="og:locale" content="en_GB" />

  <meta name="twitter:card" content="summary">
  <meta name="twitter:site" content="@philsturgeon">
  <meta name="twitter:title" content="Mocking APIs with API Blueprint | Phil Sturgeon">
  <meta name="twitter:image:src" content="https://philsturgeon.uk/images/author.jpg">
  <meta name="twitter:url" content="https://philsturgeon.uk/api/2016/12/02/mocking-apis-with-api-blueprint/">
  <meta name="twitter:description" content="The second video in a pile of LiveCoding.tv videos shows how to use your API Blueprint documentation to mock APIs, and a few different ways of serving those mocks up to people.">
  <meta name="twitter:creator" content="@philsturgeon">

  <link rel="alternate" type="application/atom+xml" title="Atom Feed" href="/feed.xml" />
</head>


  <body>

    <a class='fa fa-home logo-readium' href='/'></a>


    <!-- content start -->

    <main class="content" role="main">
      <article class="post">
        <div class="noarticleimage">
          <div class="post-meta">
            <h1 class="post-title">Mocking APIs with API Blueprint</h1>
            <div class="cf post-meta-text">
              <div class="author-image" style="background-image: url(/images/author.jpg)">Blog Logo</div>
              <h4 class="author-name" itemprop="author" itemscope itemtype="http://schema.org/Person">Phil Sturgeon</h4>
              on
              <time datetime="2016-12-02 13:01:00 UTC">
                Dec  2 2016
              </time>
              <a href="/tag/building-rest-apis-in-rails/">#building-rest-apis-in-rails</a>
              <a href="/tag/http/">#http</a>
              <a href="/tag/api/">#api</a>
              <a href="/tag/apiblueprint/">#apiblueprint</a>
              <a href="/tag/video/">#video</a>
              <a href="/tag/mocking/">#mocking</a>
            </div>
          </div>
        </div>
        <br>
        <br>
        <br>
        <section class="post-content">
          <div class="post-reading">
            <span class="post-reading-time"></span> read
          </div>
          <a name="topofpage"></a>
          <p>More videos in this practice series "Building REST APIs with Rails":</p>
<ul>
  <li>
    Episode 1:
    <a href='/api/2016/11/22/apis-documentation-first/'>Documenting Your API First</a>
  </li>
  <li>
    Episode 2:
    <a href='/api/2016/12/02/mocking-apis-with-api-blueprint/'>Mocking APIs with API Blueprint</a>
  </li>
  <li>
    Episode 3:
    <a href='/api/2016/12/11/building-apis-with-rails-basic-serialization/'>Basic Serialization</a>
  </li>
  <li>
    Episode 4:
    <a href='/api/2016/12/21/building-rest-apis-with-rails-documentation-testing/'>Documentation Testing</a>
  </li>
  <li>
    Episode 5 & 6:
    <a href='/api/2017/01/03/building-apis-with-rails-handling-errors-nicely/'>Handling Errors Nicely</a>
  </li>
</ul>
<hr>

          <p>The second video in a pile of <a href="http://livecoding.tv/philsturgeon/">LiveCoding.tv</a> videos shows how to use your API Blueprint documentation to mock APIs, and a few different ways of serving those mocks up to people.</p>

<p>Using a mock server, you can basically see how an API would work, without actually building anything. This is really helpful as early on you can agonise over which tools to use, what names to use, design decisions, and all sorts of other stuff as you "um-and-ahh" about getting this set up.</p>

<p><em><strong>Side-note:</strong> That's what <a href="https://apisyouwonthate.com">"Build APIs You Won't Hate: eBook &amp; Paperback"</a> is for. To try and reduce the initial flip flopping around on design decisions as you get started.</em></p>

<p>One popular API specification tool is <a href="http://apiblueprint.com/">API Blueprint</a>, which is built by the folks over at <a href="https://apiary.io">Apiary.io</a>. Apiary will - amongst other things - give you a mock server without you needing to do anything. You simply use their editor to make your documentation, and they'll produce a mock server for you!</p>

<iframe width="560" height="315" src="https://www.youtube.com/embed/xRJovXtzLPc" frameborder="0" allowfullscreen=""></iframe>

<p>In the video I forgot how to ngrok, but I covered it in the notes below.</p>

<p><strong><a href="https://github.com/philsturgeon/livecoding-apisyouwonthate/tree/master/episode-02-mocking-apis">Source Code</a></strong></p>

<h2 id="interested-in-a-proper-series">Interested in a Proper Series?</h2>

<p>These rough videos will be replaced with a nicely recorded series, and to get updates about that, just let me know your email address.</p>

<!-- Begin MailChimp Signup Form -->
<link href="//cdn-images.mailchimp.com/embedcode/horizontal-slim-10_7.css" rel="stylesheet" type="text/css" />

<style type="text/css">
	#mc_embed_signup{background:#fff; clear:left; font:14px; width:100%;}
	/* Add your own MailChimp form style overrides in your site stylesheet or in this style block.
	   We recommend moving this block and the preceding CSS link to the HEAD of your HTML file. */
</style>

<div id="mc_embed_signup">
<form action="//apisyouwonthate.us10.list-manage.com/subscribe/post?u=f5c5ff66d95d11dec1b88cf54&amp;id=bef95bfd48" method="post" id="mc-embedded-subscribe-form" name="mc-embedded-subscribe-form" class="validate" target="_blank" novalidate="">
    <div id="mc_embed_signup_scroll">

	<input type="email" value="" name="EMAIL" class="email" id="mce-EMAIL" placeholder="email address" required="" />
    <!-- real people should not fill this in and expect good things - do not remove this or risk form bot signups-->
    <div style="position: absolute; left: -5000px;" aria-hidden="true"><input type="text" name="b_f5c5ff66d95d11dec1b88cf54_bef95bfd48" tabindex="-1" value="" /></div>
    <div class="clear"><input type="submit" value="Subscribe" name="subscribe" id="mc-embedded-subscribe" class="button" /></div>
    </div>
</form>
</div>

<!--End mc_embed_signup-->

<h2 id="notes">Notes</h2>

<p>Go to your API in Apiary and click Inspector. At the top it will have a mock server host name:</p>

<blockquote>
  <p>http://private-3a141-philsturgeon.apiary-mock.com/</p>
</blockquote>

<p>If you navigate to this in your browser, you will see a list of routes defined in your Apiary, so
grab one of those.</p>

<pre class="highlight shell"><code><span class="gp">$ </span>http GET http://private-3a141-philsturgeon.apiary-mock.com/products
</code></pre>

<p>Here you will see output, generated from our data structures and example values:</p>

<pre class="highlight http"><code><span class="k">HTTP</span><span class="o">/</span><span class="m">1.1</span> <span class="m">200</span> <span class="ne">OK</span>
<span class="na">Access-Control-Allow-Methods</span><span class="p">:</span> <span class="s">OPTIONS,GET,HEAD,POST,PUT,DELETE,TRACE,CONNECT</span>
<span class="na">Access-Control-Allow-Origin</span><span class="p">:</span> <span class="s">*</span>
<span class="na">Access-Control-Max-Age</span><span class="p">:</span> <span class="s">10</span>
<span class="na">Connection</span><span class="p">:</span> <span class="s">keep-alive</span>
<span class="na">Content-Length</span><span class="p">:</span> <span class="s">320</span>
<span class="na">Content-Type</span><span class="p">:</span> <span class="s">application/json</span>
<span class="na">Date</span><span class="p">:</span> <span class="s">Tue, 30 Aug 2016 18:49:49 GMT</span>
<span class="na">Server</span><span class="p">:</span> <span class="s">Cowboy</span>
<span class="na">Via</span><span class="p">:</span> <span class="s">1.1 vegur</span>
<span class="na">X-Apiary-Ratelimit-Limit</span><span class="p">:</span> <span class="s">120</span>
<span class="na">X-Apiary-Ratelimit-Remaining</span><span class="p">:</span> <span class="s">119</span>
<span class="na">X-Apiary-Transaction-Id</span><span class="p">:</span> <span class="s">57c5d54d0ace330b004cddee</span>

<span class="p">[</span><span class="w">
    </span><span class="p">{</span><span class="w">
        </span><span class="nt">"apv"</span><span class="p">:</span><span class="w"> </span><span class="mf">7.4</span><span class="p">,</span><span class="w">
        </span><span class="nt">"description"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Tastes like apple juice but knocks you on your arse."</span><span class="p">,</span><span class="w">
        </span><span class="nt">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"djkfh34t234t"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"image_url"</span><span class="p">:</span><span class="w"> </span><span class="s2">"http://example.com/ciders/old-bris.jpg"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Old Bristolian"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"relationships"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
            </span><span class="nt">"manufacturer"</span><span class="p">:</span><span class="w"> </span><span class="s2">""</span><span class="p">,</span><span class="w">
            </span><span class="nt">"recent_reviews"</span><span class="p">:</span><span class="w"> </span><span class="s2">""</span><span class="w">
        </span><span class="p">},</span><span class="w">
        </span><span class="nt">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"cider"</span><span class="w">
    </span><span class="p">}</span><span class="w">
</span><span class="p">]</span><span class="w">
</span></code></pre>

<p>Alternatively, because Apiary is a paid service, you might want to use some free tools. Running
a mock server locally is easy with <a href="https://www.npmjs.com/package/drakov">drakov</a>!</p>

<pre class="highlight shell"><code><span class="gp">$ </span>npm install -g drakov
<span class="gp">$ </span>drakov -f apiary.apib
</code></pre>

<p>Again, you can use a HTTP client to test the response:</p>

<pre class="highlight plaintext"><code>$ http GET http://localhost:3000/products --json
</code></pre>

<pre class="highlight http"><code><span class="k">HTTP</span><span class="o">/</span><span class="m">1.1</span> <span class="m">200</span> <span class="ne">OK</span>
<span class="na">Access-Control-Allow-Credentials</span><span class="p">:</span> <span class="s">true</span>
<span class="na">Access-Control-Allow-Headers</span><span class="p">:</span> <span class="s">Origin, X-Requested-With, Content-Type, Accept</span>
<span class="na">Access-Control-Allow-Origin</span><span class="p">:</span> <span class="s">*</span>
<span class="na">Connection</span><span class="p">:</span> <span class="s">keep-alive</span>
<span class="na">Content-Length</span><span class="p">:</span> <span class="s">344</span>
<span class="na">Content-Type</span><span class="p">:</span> <span class="s">application/json</span>
<span class="na">Date</span><span class="p">:</span> <span class="s">Tue, 30 Aug 2016 19:03:33 GMT</span>
<span class="na">ETag</span><span class="p">:</span> <span class="s">W/"158-JzY5bB7n307mn5JL95pPGw"</span>
<span class="na">X-Powered-By</span><span class="p">:</span> <span class="s">Drakov API Server</span>

<span class="p">[</span><span class="w">
    </span><span class="p">{</span><span class="w">
        </span><span class="nt">"apv"</span><span class="p">:</span><span class="w"> </span><span class="mf">7.4</span><span class="p">,</span><span class="w">
        </span><span class="nt">"description"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Tastes like apple juice but knocks you on your arse."</span><span class="p">,</span><span class="w">
        </span><span class="nt">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"d66c7429-d8e0-4772-85b4-c18e66564e88"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"image_url"</span><span class="p">:</span><span class="w"> </span><span class="s2">"http://example.com/ciders/old-bris.jpg"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Old Bristolian"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"relationships"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
            </span><span class="nt">"manufacturer"</span><span class="p">:</span><span class="w"> </span><span class="s2">""</span><span class="p">,</span><span class="w">
            </span><span class="nt">"recent_reviews"</span><span class="p">:</span><span class="w"> </span><span class="s2">""</span><span class="w">
        </span><span class="p">},</span><span class="w">
        </span><span class="nt">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"cider"</span><span class="w">
    </span><span class="p">}</span><span class="w">
</span><span class="p">]</span><span class="w">
</span></code></pre>

<p>Then, if you want to share this with other people, one solution is to offer your local copy over <a href="https://ngrok.com/">ngrok</a>. This will
make a local tunnel to the drakov server you have running.</p>

<pre class="highlight shell"><code><span class="gp">$ </span>brew cask install ngrok
</code></pre>

<p>Assuming you still have drakov running on port 3000, you can now run this in another session:</p>

<pre class="highlight plaintext"><code>$ ngrok http 3000

ngrok by @inconshreveable                                                            (Ctrl+C to quit)

Tunnel Status                 online
Version                       2.1.3
Region                        United States (us)
Web Interface                 http://127.0.0.1:4040
Forwarding                    http://xxxxxx.ngrok.io -&gt; localhost:3000
Forwarding                    https://xxxxxx.ngrok.io -&gt; localhost:3000
</code></pre>

<p>The Web Interface will give you an inspector very much like Apiary, and the forwarding links are a host you can share with others on your team.</p>

<h1 id="in-another-tab">In ANOTHER tabâ€¦</h1>

<pre class="highlight shell"><code><span class="gp">$ </span>http GET http://xxxxxx.ngrok.io/products --json
</code></pre>

<p>Once again you should see the collection. You can now share the <code>http://xxxxxx.ngrok.io</code> host name with your coworkers, family and friends, and snoop on the traffic as it comes in, if you should so wish.</p>

<p>If you'd like to have a more permanent solution, consider shoving draokv on a free Heroku instance.</p>

<p>Personally, I quite like having the tunnel turn off in my control, as it stops people relying on this mock for too long. It gives them a chance to give feedback, but stops people relying on it for their test suites permanently.</p>

<p>Fin!</p>

          <hr>
<p>
  <em>If you appreciate these articles and want me to keep them coming, fire some coins over. Maybe I'll even run the next one through a spell checker.</em>
</p>
<p>
  <em>
    <strong>bitcoin</strong> - 1PNbuCjgATjaaHtq7zZKqe3FBL7ngyDi23<br/>
    <strong>etherium</strong> - 0x507d6E943885a5AeD76Fa3C43dB5C73a0f1Dc792
  </em>
</p>

        </section>
        <footer class="post-footer">
            <section class="share">
            </section>
            <section class="post-next-previous">
                <p>
                    Previous:
                    <a class="button" href="/api/2016/11/22/apis-documentation-first/">API Documentation: Do it First</a>
                </p>
                <p style="float:right">
                    Next:
                    <a class="button" href="/api/2016/12/11/building-rest-apis-with-rails-basic-serialization/">Building REST APIs with Rails: Basic Serialization</a>
                </p>
            </section>
        </footer>
        <div class="bottom-teaser cf">
          <div class="more isLeft">
            <h5 class="index-headline featured"><span>Written by</span></h5>
            <section class="author">
              <div class="author-image" style="background-image: url(/images/author.jpg)">Blog Logo</div>
              <h4>Phil Sturgeon</h4>
              <p class="bio">Platform Engineer @ WeWork who talks about APIs a lot. Programming Polyglot, Pragmatist, Centerist and Sarcasist. Ex-The League of Extraordinary Packages, PHP The Right Way, Ex-PHP-FIG, Ex-CodeIgniter, Ex-FuelPHP, Ex-PyroCMS.</p>
            </section>
          </div>
          <div class="more isRight">
            <h5 class="index-headline featured"><span>More Writing</span></h5>
            <section class="author">
              <a href="http://apisyouwonthate.com/">
                <div class="book-image build-apis">Book Cover</div>
                <h4>Build APIs You Won't Hate</h4>
              </a>
              <p class="bio">Everyone and their dog wants an API, so you should probably learn how to build them.</p>
              <p><a href="http://apisyouwonthate.com/">Buy it from LeanPub or Amazon</a>.</p>
            </section>
          </div>
        </div>
      </article>

      <div id="disqus_thread"></div>
      <script type="text/javascript">
          /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
          var disqus_shortname = 'philsturgeon';


          /* * * DON'T EDIT BELOW THIS LINE * * */
          (function() {
              var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
              dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
              (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
          })();
      </script>
      <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>

    </main>
    <div class="bottom-closer">
      <div class="background-closer-image" style="background-image: url(/images/cover.jpg)">
        Image
      </div>
      <div class="inner">
        <h1 class="blog-title">Phil Sturgeon</h1>
        <h2 class="blog-description">Platform Engineer @ WeWork who talks about APIs a lot. Programming Polyglot, Pragmatist, Centerist and Sarcasist. Ex-The League of Extraordinary Packages, PHP The Right Way, Ex-PHP-FIG, Ex-CodeIgniter, Ex-FuelPHP, Ex-PyroCMS.</h2>
        <a href="/" class="btn">Back to Overview</a>
      </div>
    </div>

    <!-- content end -->

    <footer class='footer' role='contentinfo'>
  <div class='footer-links'>
    <ul class='context'>
      <li>
        <h3>Content</h3>
      </li>
      <li>
        <a href='/about'>About</a>
      </li>
      <li>
        <a href='/books'>Books</a>
      </li>
      <li>
        <a href='/speaking'>Speaking</a>
      </li>
    </ul>
    <ul class='follow'>
      <li>
        <h3>Follow Me</h3>
      </li>
      <li>
        <a href='https://twitter.com/philsturgeon'>Twitter</a>
      </li>
      <li>
        <a href='https://github.com/philsturgeon'>GitHub</a>
      </li>
      <li>
        <a href='http://apibusters.com/'>API Busters Podcast</a>
      </li>
      <li>
        <a href='http://phil.bike/'>Phil.Bike</a>
      </li>
    </ul>
    <ul class='recent_posts'>
      <li>
        <h3>Recent Posts</h3>
        <ul>
          <li><a href="/api/2018/04/13/openapi-and-json-schema-divergence-solved/">OpenAPI and JSON Schema Divergence: Part 2</a></li>
          <li><a href="/api/2018/03/30/openapi-and-json-schema-divergence/">OpenAPI and JSON Schema Divergence: Part 1</a></li>
          <li><a href="/api/2018/03/01/api-specification-workflow-matures/">Design-first API Specification Workflow Matures</a></li>
        </ul>
      </li>
    </ul>
  </div>
</footer>

    <script src="//code.jquery.com/jquery-1.11.3.min.js"></script>
<script src="/javascripts/jquery.fitvids.js"></script>
<script src="/javascripts/index.js"></script>
<script src="/javascripts/readingTime.min.js"></script>
<script>
(function ($) {
  "use strict";
  $(document).ready(function(){

    var $window = $(window),
    $image = $('.post-image-image, .teaserimage-image');
    $window.on('scroll', function() {
      var top = $window.scrollTop();

      if (top < 0 || top > 1500) { return; }
      $image
        .css('transform', 'translate3d(0px, '+top/3+'px, 0px)')
        .css('opacity', 1-Math.max(top/700, 0));
    });
    $window.trigger('scroll');

    var height = $('.article-image').height();
    $('.post-content').css('padding-top', height + 'px');

    $('a[href*=#]:not([href=#])').click(function() {
      if (location.pathname.replace(/^\//,'') == this.pathname.replace(/^\//,'')
       && location.hostname == this.hostname) {
        var target = $(this.hash);
        target = target.length ? target : $('[name=' + this.hash.slice(1) +']');
        if (target.length) {
          $('html,body').animate({ scrollTop: target.offset().top }, 500);
          return false;
        }
      }
    });
  });
}(jQuery));
</script>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-8523256-1', 'auto');
  ga('send', 'pageview');

</script>


  </body>

</html>
